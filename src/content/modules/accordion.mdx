---
title: アコーディオン（ディスクロージャ）
description: div構成。多段でも軽い。max-heightで安全にトランジション。
tags: [accordion, disclosure, ui]
frameworks: [Vanilla, Any]
level: basic
prompt_template: |
  アコーディオンを実装：
  - button[aria-expanded] + セクション[hidden]構成
  - 1つだけ展開 or 複数展開モード切替可能
  - トランジションはmax-height利用
---

import LiveDemo from '../../components/LiveDemo.astro';

<LiveDemo
  title="アコーディオンのデモ"
  height="350px"
  html={`
<div class="accordion" data-mode="single">
  <button class="acc-btn" aria-expanded="false" aria-controls="acc1">
    <span>📦 配送について</span>
    <span class="acc-icon">▼</span>
  </button>
  <div id="acc1" class="acc-panel" hidden>
    全国一律送料無料。通常2-3営業日でお届けします。お急ぎの場合は特急便（有料）もご利用いただけます。
  </div>

  <button class="acc-btn" aria-expanded="false" aria-controls="acc2">
    <span>💳 支払い方法</span>
    <span class="acc-icon">▼</span>
  </button>
  <div id="acc2" class="acc-panel" hidden>
    クレジットカード、銀行振込、代金引換、コンビニ決済に対応しています。
  </div>

  <button class="acc-btn" aria-expanded="false" aria-controls="acc3">
    <span>🔄 返品・交換</span>
    <span class="acc-icon">▼</span>
  </button>
  <div id="acc3" class="acc-panel" hidden>
    商品到着後7日以内であれば、未開封の商品に限り返品・交換を承ります。
  </div>
</div>
  `}
  css={`
.accordion { max-width: 600px; }

.acc-btn {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  background: #1f2a37;
  border: 1px solid #374151;
  border-bottom: none;
  color: #e5edf4;
  cursor: pointer;
  font-size: 1rem;
  transition: background 0.2s;
}

.acc-btn:last-of-type { border-bottom: 1px solid #374151; }
.acc-btn:hover { background: #374151; }

.acc-icon {
  transition: transform 0.2s;
  font-size: 0.75rem;
}

.acc-btn[aria-expanded="true"] .acc-icon {
  transform: rotate(180deg);
}

.acc-panel {
  overflow: hidden;
  max-height: 0;
  transition: max-height 0.3s ease;
  padding: 0 1rem;
  background: #0c1218;
  border: 1px solid #374151;
  border-top: none;
  color: #9ca3af;
  line-height: 1.6;
}

.acc-panel[hidden] { display: block; }

.acc-btn[aria-expanded="true"] + .acc-panel {
  max-height: 300px;
  padding: 1rem;
}
  `}
  js={`
document.querySelectorAll('.accordion').forEach(root => {
  const single = root.dataset.mode === 'single';
  root.addEventListener('click', (e) => {
    const btn = e.target.closest('.acc-btn');
    if (!btn) return;
    const panel = document.getElementById(btn.getAttribute('aria-controls'));
    const open = btn.getAttribute('aria-expanded') === 'true';
    if (single) {
      root.querySelectorAll('.acc-btn[aria-expanded="true"]').forEach(b => {
        if (b !== btn) {
          b.setAttribute('aria-expanded','false');
          const p = document.getElementById(b.getAttribute('aria-controls'));
          p.hidden = true;
        }
      });
    }
    btn.setAttribute('aria-expanded', String(!open));
    panel.hidden = open;
  });
});
  `}
/>

## 実装コード

**HTML**
```html
<div class="accordion" data-mode="single">
  <button class="acc-btn" aria-expanded="false" aria-controls="acc1">項目1</button>
  <div id="acc1" class="acc-panel" hidden>内容1</div>

  <button class="acc-btn" aria-expanded="false" aria-controls="acc2">項目2</button>
  <div id="acc2" class="acc-panel" hidden>内容2</div>
</div>
```

**CSS**
```css
.acc-panel { overflow:hidden; max-height:0; transition:max-height .2s ease; }
.acc-panel[hidden] { display:block; }
.acc-btn[aria-expanded="true"] + .acc-panel { max-height: 300px; }
```

**JS**
```js
(() => {
  document.querySelectorAll('.accordion').forEach(root => {
    const single = root.dataset.mode === 'single';
    root.addEventListener('click', (e) => {
      const btn = e.target.closest('.acc-btn');
      if (!btn) return;
      const panel = document.getElementById(btn.getAttribute('aria-controls'));
      const open = btn.getAttribute('aria-expanded') === 'true';
      if (single) {
        root.querySelectorAll('.acc-btn[aria-expanded="true"]').forEach(b => {
          if (b !== btn) {
            b.setAttribute('aria-expanded','false');
            const p = document.getElementById(b.getAttribute('aria-controls'));
            p.hidden = true;
          }
        });
      }
      btn.setAttribute('aria-expanded', String(!open));
      panel.hidden = open;
    });
  });
})();
```