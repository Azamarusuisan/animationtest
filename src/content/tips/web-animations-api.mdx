---
title: Web Animations APIã§é«˜åº¦ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
description: JavaScriptã§CSSã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Œå…¨ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹æœ€æ–°ã®APIæ´»ç”¨æ³•
tags: [javascript, animation, web-animations-api, waapi]
category: animation
level: advanced
date: 2025-11-11
---

import LiveDemo from '../../components/LiveDemo.astro';

## Web Animations API ã¨ã¯

Web Animations API (WAAPI) ã¯ã€CSS ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨åŒç­‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æŒã¡ãªãŒã‚‰ã€JavaScript ã§å®Œå…¨ã«åˆ¶å¾¡ã§ãã‚‹å¼·åŠ›ãª API ã§ã™ã€‚CSS ã§ã¯é›£ã—ã„å‹•çš„ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã€ç´°ã‹ã„åˆ¶å¾¡ãŒå¿…è¦ãªå ´é¢ã§æ´»èºã—ã¾ã™ã€‚

### CSS Animation vs Web Animations API

<LiveDemo
  title="CSS vs WAAPI ã®æ¯”è¼ƒ"
  height="550px"
  html={`
<div class="waapi-comparison">
  <div class="comparison-card">
    <h3>CSS Animation</h3>
    <div class="demo-box">
      <div class="box css-box">CSS</div>
    </div>
    <div class="info-section">
      <p class="pros">âœ“ ã‚·ãƒ³ãƒ—ãƒ«ã§æ›¸ãã‚„ã™ã„</p>
      <p class="cons">âœ— å‹•çš„ãªåˆ¶å¾¡ãŒé›£ã—ã„</p>
      <p class="cons">âœ— ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ãŒè¤‡é›‘</p>
    </div>
  </div>

  <div class="comparison-card">
    <h3>Web Animations API</h3>
    <div class="demo-box">
      <div class="box waapi-box" id="waapiBox">WAAPI</div>
    </div>
    <div class="info-section">
      <p class="pros">âœ“ å®Œå…¨ãªJavaScriptåˆ¶å¾¡</p>
      <p class="pros">âœ“ å†ç”Ÿ/ä¸€æ™‚åœæ­¢/é€†å†ç”Ÿ</p>
      <p class="pros">âœ“ Promise ã§ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†</p>
    </div>
    <div class="controls">
      <button class="ctrl-btn" id="playBtn">å†ç”Ÿ</button>
      <button class="ctrl-btn" id="pauseBtn">ä¸€æ™‚åœæ­¢</button>
      <button class="ctrl-btn" id="reverseBtn">é€†å†ç”Ÿ</button>
      <button class="ctrl-btn" id="cancelBtn">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    </div>
  </div>
</div>
  `}
  css={`
.waapi-comparison {
  max-width: 700px;
  margin: 0 auto;
  padding: 1.5rem;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
}

.comparison-card {
  background: #1f2a37;
  border-radius: 8px;
  padding: 1.5rem;
}

.comparison-card h3 {
  font-size: 1rem;
  color: #e5edf4;
  margin: 0 0 1rem 0;
}

.demo-box {
  background: #0c1218;
  border-radius: 6px;
  padding: 2rem;
  margin-bottom: 1rem;
  min-height: 120px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.box {
  width: 80px;
  height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  color: white;
  font-weight: 700;
  font-size: 1rem;
}

.css-box {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  animation: float 2s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-20px); }
}

.waapi-box {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.info-section {
  margin-bottom: 1rem;
}

.pros,
.cons {
  font-size: 0.875rem;
  margin: 0.25rem 0;
}

.pros {
  color: #10b981;
}

.cons {
  color: #9ca3af;
}

.controls {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.5rem;
}

.ctrl-btn {
  padding: 0.5rem;
  background: #374151;
  border: 1px solid #4b5563;
  border-radius: 6px;
  color: #e5edf4;
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}

.ctrl-btn:hover {
  background: #4b5563;
}

@media (max-width: 640px) {
  .waapi-comparison {
    grid-template-columns: 1fr;
  }
}
  `}
  js={`
const waapiBox = document.getElementById('waapiBox');
const playBtn = document.getElementById('playBtn');
const pauseBtn = document.getElementById('pauseBtn');
const reverseBtn = document.getElementById('reverseBtn');
const cancelBtn = document.getElementById('cancelBtn');

const animation = waapiBox.animate(
  [
    { transform: 'translateY(0)' },
    { transform: 'translateY(-20px)' },
    { transform: 'translateY(0)' }
  ],
  {
    duration: 2000,
    iterations: Infinity,
    easing: 'ease-in-out'
  }
);

playBtn.addEventListener('click', () => animation.play());
pauseBtn.addEventListener('click', () => animation.pause());
reverseBtn.addEventListener('click', () => animation.reverse());
cancelBtn.addEventListener('click', () => animation.cancel());
  `}
/>

## åŸºæœ¬çš„ãªä½¿ã„æ–¹

### ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

```javascript
const element = document.querySelector('.box');

// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
const animation = element.animate(
  // ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ 
  [
    { transform: 'translateX(0)', opacity: 1 },
    { transform: 'translateX(100px)', opacity: 0.5 }
  ],
  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³
  {
    duration: 500,
    easing: 'ease-out',
    fill: 'forwards' // çµ‚äº†çŠ¶æ…‹ã‚’ç¶­æŒ
  }
);
```

### ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã®æ›¸ãæ–¹

```javascript
// æ–¹æ³•1: é…åˆ—å½¢å¼
const keyframes = [
  { opacity: 0, transform: 'scale(0.5)' },
  { opacity: 1, transform: 'scale(1)' }
];

// æ–¹æ³•2: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå½¢å¼
const keyframes = {
  opacity: [0, 1],
  transform: ['scale(0.5)', 'scale(1)']
};

// æ–¹æ³•3: ã‚ªãƒ•ã‚»ãƒƒãƒˆæŒ‡å®š
const keyframes = [
  { opacity: 0, offset: 0 },      // 0%
  { opacity: 1, offset: 0.3 },    // 30%
  { opacity: 0.5, offset: 1 }     // 100%
];
```

## é«˜åº¦ãªåˆ¶å¾¡

<LiveDemo
  title="ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Œå…¨åˆ¶å¾¡"
  height="650px"
  html={`
<div class="advanced-control-demo">
  <div class="animation-area">
    <div class="animated-element" id="animatedElement">
      ğŸš€
    </div>
  </div>

  <div class="control-panel">
    <div class="control-section">
      <h4>åŸºæœ¬æ“ä½œ</h4>
      <div class="btn-grid">
        <button class="action-btn" id="startBtn">é–‹å§‹</button>
        <button class="action-btn" id="pauseAnimBtn">ä¸€æ™‚åœæ­¢</button>
        <button class="action-btn" id="resumeBtn">å†é–‹</button>
        <button class="action-btn" id="reverseAnimBtn">é€†å†ç”Ÿ</button>
        <button class="action-btn" id="finishBtn">å®Œäº†</button>
        <button class="action-btn" id="cancelAnimBtn">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </div>
    </div>

    <div class="control-section">
      <h4>å†ç”Ÿé€Ÿåº¦</h4>
      <div class="speed-controls">
        <button class="speed-btn" data-speed="0.5">0.5x</button>
        <button class="speed-btn" data-speed="1">1x</button>
        <button class="speed-btn" data-speed="2">2x</button>
        <button class="speed-btn" data-speed="4">4x</button>
      </div>
    </div>

    <div class="control-section">
      <h4>çŠ¶æ…‹è¡¨ç¤º</h4>
      <div class="status-display">
        <div class="status-item">
          <span>çŠ¶æ…‹:</span>
          <span id="statusText" class="status-value">idle</span>
        </div>
        <div class="status-item">
          <span>é€²è¡Œåº¦:</span>
          <span id="progressText" class="status-value">0%</span>
        </div>
        <div class="status-item">
          <span>é€Ÿåº¦:</span>
          <span id="speedText" class="status-value">1x</span>
        </div>
      </div>
    </div>
  </div>
</div>
  `}
  css={`
.advanced-control-demo {
  max-width: 600px;
  margin: 0 auto;
  padding: 1.5rem;
}

.animation-area {
  background: linear-gradient(135deg, #0c1218 0%, #1f2a37 100%);
  border-radius: 8px;
  height: 200px;
  position: relative;
  margin-bottom: 1.5rem;
  overflow: hidden;
}

.animated-element {
  position: absolute;
  font-size: 3rem;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  user-select: none;
}

.control-panel {
  background: #1f2a37;
  border-radius: 8px;
  padding: 1.5rem;
}

.control-section {
  margin-bottom: 1.5rem;
}

.control-section:last-child {
  margin-bottom: 0;
}

.control-section h4 {
  font-size: 0.875rem;
  color: #9ca3af;
  margin: 0 0 0.75rem 0;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.btn-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.5rem;
}

.action-btn {
  padding: 0.5rem;
  background: #374151;
  border: 1px solid #4b5563;
  border-radius: 6px;
  color: #e5edf4;
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.action-btn:hover {
  background: #4b5563;
  transform: translateY(-1px);
}

.speed-controls {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.5rem;
}

.speed-btn {
  padding: 0.5rem;
  background: #374151;
  border: 1px solid #4b5563;
  border-radius: 6px;
  color: #e5edf4;
  font-size: 0.875rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.speed-btn:hover,
.speed-btn.active {
  background: #10b981;
  border-color: #10b981;
  color: white;
}

.status-display {
  background: #0c1218;
  border-radius: 6px;
  padding: 1rem;
}

.status-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem 0;
  border-bottom: 1px solid #374151;
  font-size: 0.875rem;
}

.status-item:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

.status-item span:first-child {
  color: #9ca3af;
}

.status-value {
  color: #10b981;
  font-weight: 600;
}
  `}
  js={`
const animatedElement = document.getElementById('animatedElement');
const statusText = document.getElementById('statusText');
const progressText = document.getElementById('progressText');
const speedText = document.getElementById('speedText');

let animation = null;

function createAnimation() {
  return animatedElement.animate(
    [
      { transform: 'translateY(-50%) translateX(0) rotate(0deg)' },
      { transform: 'translateY(-50%) translateX(250px) rotate(180deg)' },
      { transform: 'translateY(-50%) translateX(500px) rotate(360deg)' }
    ],
    {
      duration: 3000,
      easing: 'ease-in-out',
      fill: 'both'
    }
  );
}

function updateStatus() {
  if (!animation) return;
  statusText.textContent = animation.playState;
  const progress = animation.currentTime / animation.effect.getTiming().duration * 100;
  progressText.textContent = Math.round(progress) + '%';
}

document.getElementById('startBtn').addEventListener('click', () => {
  if (animation) animation.cancel();
  animation = createAnimation();
  setInterval(updateStatus, 50);
});

document.getElementById('pauseAnimBtn').addEventListener('click', () => {
  if (animation) animation.pause();
});

document.getElementById('resumeBtn').addEventListener('click', () => {
  if (animation) animation.play();
});

document.getElementById('reverseAnimBtn').addEventListener('click', () => {
  if (animation) animation.reverse();
});

document.getElementById('finishBtn').addEventListener('click', () => {
  if (animation) animation.finish();
});

document.getElementById('cancelAnimBtn').addEventListener('click', () => {
  if (animation) animation.cancel();
});

document.querySelectorAll('.speed-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const speed = parseFloat(btn.dataset.speed);
    if (animation) {
      animation.playbackRate = speed;
      speedText.textContent = speed + 'x';
    }
    document.querySelectorAll('.speed-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  });
});

// åˆæœŸã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
setTimeout(() => {
  document.getElementById('startBtn').click();
}, 500);
  `}
/>

### Animation ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰

```javascript
const animation = element.animate(keyframes, options);

// å†ç”Ÿåˆ¶å¾¡
animation.play();           // å†ç”Ÿ
animation.pause();          // ä¸€æ™‚åœæ­¢
animation.reverse();        // é€†å†ç”Ÿ
animation.cancel();         // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆåˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹ï¼‰
animation.finish();         // å³åº§ã«å®Œäº†çŠ¶æ…‹ã¸

// ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
animation.playState;        // 'idle', 'running', 'paused', 'finished'
animation.playbackRate;     // å†ç”Ÿé€Ÿåº¦ï¼ˆ1 = é€šå¸¸é€Ÿåº¦ï¼‰
animation.currentTime;      // ç¾åœ¨ã®æ™‚åˆ»ï¼ˆãƒŸãƒªç§’ï¼‰
animation.startTime;        // é–‹å§‹æ™‚åˆ»
```

## Promise ã‚’ä½¿ã£ãŸã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†

<LiveDemo
  title="Promise ãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é€£é–"
  height="500px"
  html={`
<div class="promise-demo">
  <div class="sequence-area">
    <div class="sequence-box" id="box1">1</div>
    <div class="sequence-box" id="box2">2</div>
    <div class="sequence-box" id="box3">3</div>
  </div>

  <div class="promise-controls">
    <button class="promise-btn" id="sequenceBtn">é †æ¬¡ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</button>
    <button class="promise-btn" id="parallelBtn">ä¸¦åˆ—ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</button>
  </div>

  <div class="log-display" id="logDisplay">
    ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™...
  </div>
</div>
  `}
  css={`
.promise-demo {
  max-width: 600px;
  margin: 0 auto;
  padding: 1.5rem;
}

.sequence-area {
  background: #0c1218;
  border-radius: 8px;
  padding: 2rem;
  margin-bottom: 1.5rem;
  display: flex;
  justify-content: space-around;
  align-items: center;
  min-height: 150px;
}

.sequence-box {
  width: 80px;
  height: 80px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  font-size: 1.5rem;
  opacity: 0.3;
}

.promise-controls {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.promise-btn {
  padding: 0.75rem 1rem;
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  border: none;
  border-radius: 6px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s;
}

.promise-btn:hover {
  transform: translateY(-2px);
}

.log-display {
  background: #1f2a37;
  border: 1px solid #374151;
  border-radius: 6px;
  padding: 1rem;
  font-family: 'Courier New', monospace;
  font-size: 0.75rem;
  color: #10b981;
  min-height: 80px;
  line-height: 1.6;
}
  `}
  js={`
const box1 = document.getElementById('box1');
const box2 = document.getElementById('box2');
const box3 = document.getElementById('box3');
const logDisplay = document.getElementById('logDisplay');
const sequenceBtn = document.getElementById('sequenceBtn');
const parallelBtn = document.getElementById('parallelBtn');

function log(message) {
  logDisplay.textContent += message + '\\n';
}

function clearLog() {
  logDisplay.textContent = '';
}

function animateBox(box, name) {
  const animation = box.animate(
    [
      { opacity: 0.3, transform: 'scale(1)' },
      { opacity: 1, transform: 'scale(1.2)' },
      { opacity: 0.3, transform: 'scale(1)' }
    ],
    {
      duration: 500,
      easing: 'ease-in-out'
    }
  );

  log(name + ' é–‹å§‹');

  return animation.finished.then(() => {
    log(name + ' å®Œäº†');
  });
}

sequenceBtn.addEventListener('click', async () => {
  clearLog();
  log('=== é †æ¬¡å®Ÿè¡Œé–‹å§‹ ===');

  await animateBox(box1, 'ãƒœãƒƒã‚¯ã‚¹1');
  await animateBox(box2, 'ãƒœãƒƒã‚¯ã‚¹2');
  await animateBox(box3, 'ãƒœãƒƒã‚¯ã‚¹3');

  log('=== ã™ã¹ã¦å®Œäº† ===');
});

parallelBtn.addEventListener('click', async () => {
  clearLog();
  log('=== ä¸¦åˆ—å®Ÿè¡Œé–‹å§‹ ===');

  await Promise.all([
    animateBox(box1, 'ãƒœãƒƒã‚¯ã‚¹1'),
    animateBox(box2, 'ãƒœãƒƒã‚¯ã‚¹2'),
    animateBox(box3, 'ãƒœãƒƒã‚¯ã‚¹3')
  ]);

  log('=== ã™ã¹ã¦å®Œäº† ===');
});
  `}
/>

### Promise ã‚’ä½¿ã£ãŸé€£é–ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

```javascript
const element = document.querySelector('.box');

// é †æ¬¡å®Ÿè¡Œ
async function sequentialAnimation() {
  const anim1 = element.animate(
    [{ opacity: 0 }, { opacity: 1 }],
    { duration: 500 }
  );

  await anim1.finished; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†ã‚’å¾…ã¤

  const anim2 = element.animate(
    [{ transform: 'scale(1)' }, { transform: 'scale(1.2)' }],
    { duration: 300 }
  );

  await anim2.finished;

  console.log('ã™ã¹ã¦ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†');
}

// ä¸¦åˆ—å®Ÿè¡Œ
async function parallelAnimation() {
  const anim1 = element.animate(
    [{ opacity: 0 }, { opacity: 1 }],
    { duration: 500 }
  );

  const anim2 = element.animate(
    [{ transform: 'scale(1)' }, { transform: 'scale(1.2)' }],
    { duration: 500 }
  );

  await Promise.all([anim1.finished, anim2.finished]);

  console.log('ã™ã¹ã¦ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†');
}
```

## å‹•çš„ãªã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ç”Ÿæˆ

<LiveDemo
  title="å‹•çš„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ"
  height="500px"
  html={`
<div class="dynamic-demo">
  <div class="dynamic-area" id="dynamicArea">
    <div class="particle-container" id="particleContainer"></div>
  </div>

  <div class="dynamic-controls">
    <button class="dynamic-btn" id="explodeBtn">çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆ</button>
    <button class="dynamic-btn" id="waveBtn">æ³¢ç´‹ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ</button>
    <button class="dynamic-btn" id="clearBtn">ã‚¯ãƒªã‚¢</button>
  </div>
</div>
  `}
  css={`
.dynamic-demo {
  max-width: 600px;
  margin: 0 auto;
  padding: 1.5rem;
}

.dynamic-area {
  background: radial-gradient(circle at center, #1f2a37 0%, #0c1218 100%);
  border-radius: 8px;
  height: 300px;
  position: relative;
  margin-bottom: 1.5rem;
  overflow: hidden;
  cursor: pointer;
}

.particle-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.particle {
  position: absolute;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  pointer-events: none;
}

.dynamic-controls {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.75rem;
}

.dynamic-btn {
  padding: 0.75rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border: none;
  border-radius: 6px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s;
}

.dynamic-btn:hover {
  transform: translateY(-2px);
}
  `}
  js={`
const dynamicArea = document.getElementById('dynamicArea');
const particleContainer = document.getElementById('particleContainer');
const explodeBtn = document.getElementById('explodeBtn');
const waveBtn = document.getElementById('waveBtn');
const clearBtn = document.getElementById('clearBtn');

function createParticle(x, y) {
  const particle = document.createElement('div');
  particle.className = 'particle';
  particle.style.left = x + 'px';
  particle.style.top = y + 'px';
  particleContainer.appendChild(particle);
  return particle;
}

function explode(x, y) {
  const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#10b981'];
  const particleCount = 20;

  for (let i = 0; i < particleCount; i++) {
    const particle = createParticle(x, y);
    const angle = (Math.PI * 2 * i) / particleCount;
    const distance = 100 + Math.random() * 50;
    const dx = Math.cos(angle) * distance;
    const dy = Math.sin(angle) * distance;

    particle.style.background = colors[Math.floor(Math.random() * colors.length)];

    const animation = particle.animate(
      [
        { transform: 'translate(0, 0) scale(1)', opacity: 1 },
        { transform: 'translate(' + dx + 'px, ' + dy + 'px) scale(0)', opacity: 0 }
      ],
      {
        duration: 1000 + Math.random() * 500,
        easing: 'cubic-bezier(0.4, 0.0, 0.2, 1)'
      }
    );

    animation.finished.then(() => particle.remove());
  }
}

function wave(x, y) {
  const rippleCount = 3;

  for (let i = 0; i < rippleCount; i++) {
    const ripple = createParticle(x, y);
    ripple.style.background = 'transparent';
    ripple.style.border = '2px solid #10b981';
    ripple.style.width = '20px';
    ripple.style.height = '20px';
    ripple.style.marginLeft = '-10px';
    ripple.style.marginTop = '-10px';

    const animation = ripple.animate(
      [
        { transform: 'scale(0)', opacity: 1 },
        { transform: 'scale(15)', opacity: 0 }
      ],
      {
        duration: 1500,
        delay: i * 200,
        easing: 'ease-out'
      }
    );

    animation.finished.then(() => ripple.remove());
  }
}

dynamicArea.addEventListener('click', (e) => {
  const rect = dynamicArea.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  explode(x, y);
});

explodeBtn.addEventListener('click', () => {
  explode(300, 150);
});

waveBtn.addEventListener('click', () => {
  wave(300, 150);
});

clearBtn.addEventListener('click', () => {
  particleContainer.innerHTML = '';
});
  `}
/>

### å‹•çš„ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ç”Ÿæˆã®ã‚³ãƒ¼ãƒ‰

```javascript
function createDynamicAnimation(element, targetX, targetY) {
  // ãƒã‚¦ã‚¹ä½ç½®ãªã©ã‹ã‚‰å‹•çš„ã«ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ç”Ÿæˆ
  const keyframes = [
    {
      transform: `translate(0, 0)`,
      opacity: 1
    },
    {
      transform: `translate(${targetX}px, ${targetY}px)`,
      opacity: 0
    }
  ];

  return element.animate(keyframes, {
    duration: 1000,
    easing: 'ease-out'
  });
}

// ä½¿ç”¨ä¾‹: ã‚¯ãƒªãƒƒã‚¯ä½ç½®ã«å‘ã‹ã£ã¦ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
document.addEventListener('click', (e) => {
  const element = document.querySelector('.particle');
  const rect = element.getBoundingClientRect();
  const targetX = e.clientX - rect.left;
  const targetY = e.clientY - rect.top;

  createDynamicAnimation(element, targetX, targetY);
});
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. GPU ã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ´»ç”¨

```javascript
// âœ… é«˜é€Ÿ: transform ã¨ opacity ã®ã¿
element.animate(
  [
    { transform: 'translateX(0)', opacity: 1 },
    { transform: 'translateX(100px)', opacity: 0.5 }
  ],
  { duration: 500 }
);

// âŒ ä½é€Ÿ: layout ã«å½±éŸ¿
element.animate(
  [
    { left: '0px', width: '100px' },
    { left: '100px', width: '200px' }
  ],
  { duration: 500 }
);
```

### 2. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ç®¡ç†

```javascript
// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¿æŒã—ã¦å¾Œã§åˆ¶å¾¡
const animations = new Map();

function startAnimation(id, element, keyframes, options) {
  // æ—¢å­˜ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
  if (animations.has(id)) {
    animations.get(id).cancel();
  }

  const animation = element.animate(keyframes, options);
  animations.set(id, animation);

  // å®Œäº†å¾Œã«å‰Šé™¤
  animation.finished.then(() => {
    animations.delete(id);
  });

  return animation;
}
```

### 3. ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã®é˜²æ­¢

```javascript
const animation = element.animate(keyframes, options);

// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾Œã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
animation.finished
  .then(() => {
    console.log('å®Œäº†');
  })
  .catch(() => {
    console.log('ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸ');
  })
  .finally(() => {
    // ãƒªã‚½ãƒ¼ã‚¹ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
    animation.cancel();
  });
```

## ãƒ–ãƒ©ã‚¦ã‚¶ã‚µãƒãƒ¼ãƒˆ

Web Animations API ã¯ä¸»è¦ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ãŒã€å¤ã„ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ãƒãƒªãƒ•ã‚£ãƒ«ãŒå¿…è¦ã§ã™ï¼š

```javascript
// ãƒãƒªãƒ•ã‚£ãƒ«ã®ãƒã‚§ãƒƒã‚¯
if (!Element.prototype.animate) {
  // ãƒãƒªãƒ•ã‚£ãƒ«ã‚’èª­ã¿è¾¼ã‚€
  import('web-animations-js');
}
```

## CSS Animation ã¨ã®ä½¿ã„åˆ†ã‘

### CSS Animation ã‚’ä½¿ã†ã¹ãå ´åˆ

- ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- é™çš„ãªã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ 
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€å„ªå…ˆ

### WAAPI ã‚’ä½¿ã†ã¹ãå ´åˆ

- å‹•çš„ãªã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ç”Ÿæˆ
- JavaScript ã§ã®åˆ¶å¾¡ãŒå¿…è¦
- Promise ãƒ™ãƒ¼ã‚¹ã®å‡¦ç†
- å†ç”Ÿ/ä¸€æ™‚åœæ­¢/é€†å†ç”Ÿãªã©ã®åˆ¶å¾¡

## ã¾ã¨ã‚

### Web Animations API ã®åˆ©ç‚¹

1. **å®Œå…¨ãª JavaScript åˆ¶å¾¡** - play/pause/reverse ãªã©ã®æ“ä½œãŒå¯èƒ½
2. **Promise ãƒ™ãƒ¼ã‚¹** - async/await ã§ç›´æ„Ÿçš„ãªã‚³ãƒ¼ãƒ‰
3. **å‹•çš„ç”Ÿæˆ** - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã«å¿œã˜ãŸã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
4. **é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹** - CSS Animation ã¨åŒç­‰ã®é€Ÿåº¦
5. **ç´°ã‹ã„åˆ¶å¾¡** - å†ç”Ÿé€Ÿåº¦ã€é€²è¡Œåº¦ãªã©ã‚’è‡ªç”±ã«æ“ä½œ

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

- [ ] transform ã¨ opacity ã®ã¿ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] Promise ã‚’æ´»ç”¨ã—ã¦é€£é–ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…
- [ ] ä¸è¦ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ cancel() ã§è§£æ”¾
- [ ] playbackRate ã§å†ç”Ÿé€Ÿåº¦ã‚’èª¿æ•´
- [ ] finished Promise ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†

## å‚è€ƒãƒªãƒ³ã‚¯

- [Web Animations API - MDN](https://developer.mozilla.org/ja/docs/Web/API/Web_Animations_API)
- [web-animations-js (polyfill)](https://github.com/web-animations/web-animations-js)
- [Using the Web Animations API - web.dev](https://web.dev/web-animations/)
