---
title: ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
description: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…
tags: [form, validation, input, error-handling, webapp]
category: webapp
level: intermediate
date: 2025-11-12
---

import LiveDemo from '../../components/LiveDemo.astro';

## ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯

ä¼šå“¡ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã§ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã€ã¨è¨€ã‚ã‚ŒãŸã“ã¨ã‚ã‚Šã¾ã™ã‚ˆã­ï¼Ÿ
å…¥åŠ›æ¬„ã«æ–‡å­—ã‚’æ‰“ã¤ã¨ã€Œâœ“ OKã€ã¨ã‹ã€Œâœ— çŸ­ã™ãã¾ã™ã€ã£ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã‚¢ãƒ¬ã§ã™ã€‚

**ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³** = ã€Œå…¥åŠ›ãƒã‚§ãƒƒã‚¯ã€ã®ã“ã¨

### ãªãœå¿…è¦ï¼Ÿ

1. **é–“é•ã„ã‚’æ—©ãè¦‹ã¤ã‘ã‚‹**
   - é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‹ã‚‰ã€Œå…¨éƒ¨å…¥åŠ›ã—ç›´ã—ã€ã¯å«Œã§ã™ã‚ˆã­

2. **æ­£ã—ã„ãƒ‡ãƒ¼ã‚¿ã ã‘å—ã‘å–ã‚‹**
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«é›»è©±ç•ªå·ãŒå…¥åŠ›ã•ã‚ŒãŸã‚‰å›°ã‚‹

3. **ä½¿ã„ã‚„ã™ãã™ã‚‹**
   - ã€Œä½•ãŒé–“é•ã£ã¦ã‚‹ã®ï¼Ÿã€ã¨è¿·ã‚ã›ãªã„

## ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…

<LiveDemo
  title="ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ‡ãƒ¢"
  height="750px"
  html={`
<div class="validation-demo">
  <div class="demo-header">
    <h3>âœ… ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¢</h3>
    <p class="subtitle">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯</p>
  </div>

  <div class="form-container">
    <div class="form-card">
      <h4 class="form-title">ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²</h4>
      <p class="form-description">ã™ã¹ã¦ã®é …ç›®ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„</p>

      <form id="registrationForm" novalidate>
        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼å -->
        <div class="form-group">
          <label for="username" class="form-label">
            <span>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</span>
            <span class="required">*</span>
          </label>
          <input
            type="text"
            id="username"
            name="username"
            class="form-input"
            placeholder="3æ–‡å­—ä»¥ä¸Šã®è‹±æ•°å­—"
            autocomplete="off"
          />
          <div class="input-feedback">
            <div class="error-message" data-error="username"></div>
            <div class="success-message" data-success="username">âœ“ ä½¿ç”¨å¯èƒ½ã§ã™</div>
          </div>
          <div class="input-hint">3ã€œ20æ–‡å­—ã®è‹±æ•°å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢</div>
        </div>

        <!-- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ -->
        <div class="form-group">
          <label for="email" class="form-label">
            <span>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</span>
            <span class="required">*</span>
          </label>
          <input
            type="email"
            id="email"
            name="email"
            class="form-input"
            placeholder="example@email.com"
            autocomplete="off"
          />
          <div class="input-feedback">
            <div class="error-message" data-error="email"></div>
            <div class="success-message" data-success="email">âœ“ æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã™</div>
          </div>
        </div>

        <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ -->
        <div class="form-group">
          <label for="password" class="form-label">
            <span>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</span>
            <span class="required">*</span>
          </label>
          <div class="input-wrapper">
            <input
              type="password"
              id="password"
              name="password"
              class="form-input"
              placeholder="8æ–‡å­—ä»¥ä¸Š"
              autocomplete="off"
            />
            <button type="button" class="toggle-password" data-toggle="password">
              <span class="icon">ğŸ‘ï¸</span>
            </button>
          </div>
          <div class="input-feedback">
            <div class="error-message" data-error="password"></div>
          </div>

          <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
          <div class="password-strength">
            <div class="strength-bar">
              <div class="strength-fill" id="strengthFill"></div>
            </div>
            <div class="strength-text" id="strengthText">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
          </div>

          <div class="password-requirements">
            <div class="requirement" data-req="length">
              <span class="req-icon">â—‹</span>
              <span>8æ–‡å­—ä»¥ä¸Š</span>
            </div>
            <div class="requirement" data-req="lowercase">
              <span class="req-icon">â—‹</span>
              <span>å°æ–‡å­—ã‚’å«ã‚€</span>
            </div>
            <div class="requirement" data-req="uppercase">
              <span class="req-icon">â—‹</span>
              <span>å¤§æ–‡å­—ã‚’å«ã‚€</span>
            </div>
            <div class="requirement" data-req="number">
              <span class="req-icon">â—‹</span>
              <span>æ•°å­—ã‚’å«ã‚€</span>
            </div>
          </div>
        </div>

        <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª -->
        <div class="form-group">
          <label for="confirmPassword" class="form-label">
            <span>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆç¢ºèªï¼‰</span>
            <span class="required">*</span>
          </label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            class="form-input"
            placeholder="ã‚‚ã†ä¸€åº¦å…¥åŠ›"
            autocomplete="off"
          />
          <div class="input-feedback">
            <div class="error-message" data-error="confirmPassword"></div>
            <div class="success-message" data-success="confirmPassword">âœ“ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã™</div>
          </div>
        </div>

        <!-- åˆ©ç”¨è¦ç´„ -->
        <div class="form-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              id="terms"
              name="terms"
              class="form-checkbox"
            />
            <span class="checkbox-text">
              åˆ©ç”¨è¦ç´„ã«åŒæ„ã™ã‚‹
              <span class="required">*</span>
            </span>
          </label>
          <div class="input-feedback">
            <div class="error-message" data-error="terms"></div>
          </div>
        </div>

        <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
        <button type="submit" class="submit-btn" id="submitBtn" disabled>
          <span class="btn-icon">ğŸš€</span>
          <span>ç™»éŒ²ã™ã‚‹</span>
        </button>
      </form>

      <!-- ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹è¡¨ç¤º -->
      <div class="form-status">
        <div class="status-item">
          <span class="status-label">æ¤œè¨¼çŠ¶æ…‹:</span>
          <span class="status-value" id="validationStatus">æœªå…¥åŠ›</span>
        </div>
        <div class="status-item">
          <span class="status-label">ã‚¨ãƒ©ãƒ¼æ•°:</span>
          <span class="status-value error" id="errorCount">0</span>
        </div>
      </div>
    </div>
  </div>

  <div class="event-log">
    <div class="log-header">ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ</div>
    <div class="log-content" id="logContent">
      <div class="log-empty">ã‚¤ãƒ™ãƒ³ãƒˆã‚’å¾…æ©Ÿä¸­...</div>
    </div>
  </div>
</div>

<!-- æˆåŠŸãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="success-modal" id="successModal" style="display: none;">
  <div class="modal-backdrop"></div>
  <div class="modal-content">
    <div class="modal-icon">ğŸ‰</div>
    <h3>ç™»éŒ²å®Œäº†ï¼</h3>
    <p>ã™ã¹ã¦ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ</p>
    <button class="modal-btn" id="closeModal">é–‰ã˜ã‚‹</button>
  </div>
</div>
  `}
  css={`
.validation-demo {
  max-width: 700px;
  margin: 0 auto;
  padding: 1.5rem;
}

.demo-header {
  text-align: center;
  margin-bottom: 2rem;
}

.demo-header h3 {
  margin: 0 0 0.5rem 0;
  font-size: 1.5rem;
  color: #e5edf4;
}

.subtitle {
  margin: 0;
  color: #9ca3af;
  font-size: 0.9375rem;
}

.form-container {
  margin-bottom: 1.5rem;
}

.form-card {
  background: #1f2a37;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
}

.form-title {
  margin: 0 0 0.5rem 0;
  font-size: 1.5rem;
  color: #e5edf4;
}

.form-description {
  margin: 0 0 2rem 0;
  color: #9ca3af;
  font-size: 0.9375rem;
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-label {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  margin-bottom: 0.5rem;
  color: #e5edf4;
  font-weight: 600;
  font-size: 0.9375rem;
}

.required {
  color: #ef4444;
}

.input-wrapper {
  position: relative;
}

.form-input {
  width: 100%;
  padding: 0.75rem 1rem;
  background: #0c1218;
  border: 2px solid #374151;
  border-radius: 8px;
  color: #e5edf4;
  font-size: 1rem;
  transition: all 0.2s;
}

.form-input:focus {
  outline: none;
  border-color: #60a5fa;
  box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
}

.form-input.error {
  border-color: #ef4444;
}

.form-input.success {
  border-color: #10b981;
}

.toggle-password {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
  padding: 0.25rem;
  opacity: 0.6;
  transition: opacity 0.2s;
}

.toggle-password:hover {
  opacity: 1;
}

.input-feedback {
  min-height: 1.5rem;
  margin-top: 0.5rem;
}

.error-message,
.success-message {
  font-size: 0.875rem;
  display: none;
  animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.error-message {
  color: #ef4444;
}

.success-message {
  color: #10b981;
}

.error-message.show,
.success-message.show {
  display: block;
}

.input-hint {
  font-size: 0.8125rem;
  color: #6b7280;
  margin-top: 0.25rem;
}

.password-strength {
  margin-top: 0.75rem;
}

.strength-bar {
  height: 4px;
  background: #374151;
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.strength-fill {
  height: 100%;
  width: 0;
  background: #6b7280;
  transition: all 0.3s;
  border-radius: 2px;
}

.strength-fill.weak {
  width: 33%;
  background: #ef4444;
}

.strength-fill.medium {
  width: 66%;
  background: #f59e0b;
}

.strength-fill.strong {
  width: 100%;
  background: #10b981;
}

.strength-text {
  font-size: 0.8125rem;
  color: #9ca3af;
}

.password-requirements {
  margin-top: 0.75rem;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.5rem;
}

.requirement {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.8125rem;
  color: #9ca3af;
}

.req-icon {
  color: #6b7280;
  font-weight: bold;
}

.requirement.met {
  color: #10b981;
}

.requirement.met .req-icon {
  color: #10b981;
}

.requirement.met .req-icon::before {
  content: 'âœ“';
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  cursor: pointer;
}

.form-checkbox {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.checkbox-text {
  color: #e5edf4;
  font-size: 0.9375rem;
}

.submit-btn {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
  padding: 1rem;
  background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
  border: none;
  border-radius: 8px;
  color: white;
  font-size: 1.125rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  margin-top: 1rem;
}

.submit-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(96, 165, 250, 0.4);
}

.submit-btn:disabled {
  background: #374151;
  cursor: not-allowed;
  transform: none;
}

.btn-icon {
  font-size: 1.25rem;
}

.form-status {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid #374151;
}

.status-item {
  display: flex;
  justify-content: space-between;
  padding: 0.5rem 0;
  font-size: 0.875rem;
}

.status-label {
  color: #9ca3af;
}

.status-value {
  color: #10b981;
  font-weight: 600;
}

.status-value.error {
  color: #ef4444;
}

.event-log {
  background: #1f2a37;
  border-radius: 8px;
  padding: 1.5rem;
}

.log-header {
  font-size: 0.9375rem;
  font-weight: 600;
  color: #e5edf4;
  margin-bottom: 1rem;
}

.log-content {
  background: #0c1218;
  border-radius: 6px;
  padding: 1rem;
  max-height: 200px;
  overflow-y: auto;
}

.log-empty {
  text-align: center;
  color: #6b7280;
  font-size: 0.875rem;
  padding: 1rem;
}

.log-entry {
  display: flex;
  align-items: start;
  gap: 0.75rem;
  padding: 0.75rem;
  margin-bottom: 0.5rem;
  background: #1f2a37;
  border-radius: 6px;
  font-size: 0.875rem;
  animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.log-time {
  color: #60a5fa;
  font-weight: 600;
  min-width: 65px;
  font-family: monospace;
}

.log-message {
  color: #d1d5db;
  flex: 1;
}

.log-field {
  color: #10b981;
  font-weight: 600;
}

.success-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.modal-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(4px);
}

.modal-content {
  position: relative;
  background: #1f2a37;
  border-radius: 16px;
  padding: 2.5rem;
  text-align: center;
  max-width: 400px;
  animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.modal-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
}

.modal-content h3 {
  margin: 0 0 0.5rem 0;
  color: #e5edf4;
  font-size: 1.5rem;
}

.modal-content p {
  margin: 0 0 1.5rem 0;
  color: #9ca3af;
}

.modal-btn {
  padding: 0.75rem 2rem;
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  border: none;
  border-radius: 8px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.modal-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
}
  `}
  js={`
// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«
const validators = {
  username: {
    required: true,
    minLength: 3,
    maxLength: 20,
    pattern: /^[a-zA-Z0-9_]+$/,
    messages: {
      required: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯å¿…é ˆã§ã™',
      minLength: '3æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„',
      maxLength: '20æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„',
      pattern: 'è‹±æ•°å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã®ã¿ä½¿ç”¨ã§ãã¾ã™'
    }
  },
  email: {
    required: true,
    pattern: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,
    messages: {
      required: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å¿…é ˆã§ã™',
      pattern: 'æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'
    }
  },
  password: {
    required: true,
    minLength: 8,
    custom: (value) => {
      const checks = {
        length: value.length >= 8,
        lowercase: /[a-z]/.test(value),
        uppercase: /[A-Z]/.test(value),
        number: /[0-9]/.test(value)
      };
      return Object.values(checks).every(v => v);
    },
    messages: {
      required: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¿…é ˆã§ã™',
      minLength: '8æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„',
      custom: 'ã™ã¹ã¦ã®æ¡ä»¶ã‚’æº€ãŸã—ã¦ãã ã•ã„'
    }
  },
  confirmPassword: {
    required: true,
    match: 'password',
    messages: {
      required: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆç¢ºèªï¼‰ã¯å¿…é ˆã§ã™',
      match: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“'
    }
  },
  terms: {
    required: true,
    messages: {
      required: 'åˆ©ç”¨è¦ç´„ã«åŒæ„ã—ã¦ãã ã•ã„'
    }
  }
};

const form = document.getElementById('registrationForm');
const submitBtn = document.getElementById('submitBtn');
const logContent = document.getElementById('logContent');
const validationStatus = document.getElementById('validationStatus');
const errorCount = document.getElementById('errorCount');
const successModal = document.getElementById('successModal');

let errors = {};

// ãƒ­ã‚°è¿½åŠ 
function addLog(message, field = null) {
  if (logContent.querySelector('.log-empty')) {
    logContent.innerHTML = '';
  }

  const entry = document.createElement('div');
  entry.className = 'log-entry';
  const now = new Date();
  const timeStr = now.toLocaleTimeString('ja-JP', {
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit'
  });

  const fieldHtml = field ? \` <span class="log-field">\${field}</span>\` : '';
  entry.innerHTML = \`
    <span class="log-time">\${timeStr}</span>
    <span class="log-message">\${message}\${fieldHtml}</span>
  \`;

  logContent.insertBefore(entry, logContent.firstChild);

  while (logContent.children.length > 10) {
    logContent.removeChild(logContent.lastChild);
  }
}

// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
function validateField(name, value) {
  const rules = validators[name];
  if (!rules) return null;

  // å¿…é ˆãƒã‚§ãƒƒã‚¯
  if (rules.required && !value) {
    return rules.messages.required;
  }

  // æœ€å°æ–‡å­—æ•°
  if (rules.minLength && value.length < rules.minLength) {
    return rules.messages.minLength;
  }

  // æœ€å¤§æ–‡å­—æ•°
  if (rules.maxLength && value.length > rules.maxLength) {
    return rules.messages.maxLength;
  }

  // ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒã‚§ãƒƒã‚¯
  if (rules.pattern && !rules.pattern.test(value)) {
    return rules.messages.pattern;
  }

  // ãƒãƒƒãƒãƒã‚§ãƒƒã‚¯ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèªç”¨ï¼‰
  if (rules.match) {
    const matchField = document.getElementById(rules.match);
    if (value !== matchField.value) {
      return rules.messages.match;
    }
  }

  // ã‚«ã‚¹ã‚¿ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  if (rules.custom && !rules.custom(value)) {
    return rules.messages.custom;
  }

  return null;
}

// ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
function showError(name, message) {
  const input = document.getElementById(name);
  const errorEl = document.querySelector(\`[data-error="\${name}"]\`);
  const successEl = document.querySelector(\`[data-success="\${name}"]\`);

  input.classList.add('error');
  input.classList.remove('success');

  if (errorEl) {
    errorEl.textContent = message;
    errorEl.classList.add('show');
  }

  if (successEl) {
    successEl.classList.remove('show');
  }

  errors[name] = message;
}

// æˆåŠŸè¡¨ç¤º
function showSuccess(name) {
  const input = document.getElementById(name);
  const errorEl = document.querySelector(\`[data-error="\${name}"]\`);
  const successEl = document.querySelector(\`[data-success="\${name}"]\`);

  input.classList.remove('error');
  input.classList.add('success');

  if (errorEl) {
    errorEl.classList.remove('show');
  }

  if (successEl) {
    successEl.classList.add('show');
  }

  delete errors[name];
}

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯
function checkPasswordStrength(password) {
  const strengthFill = document.getElementById('strengthFill');
  const strengthText = document.getElementById('strengthText');

  const checks = {
    length: password.length >= 8,
    lowercase: /[a-z]/.test(password),
    uppercase: /[A-Z]/.test(password),
    number: /[0-9]/.test(password)
  };

  // è¦ä»¶ã®è¡¨ç¤ºã‚’æ›´æ–°
  Object.keys(checks).forEach(key => {
    const req = document.querySelector(\`[data-req="\${key}"]\`);
    if (checks[key]) {
      req.classList.add('met');
    } else {
      req.classList.remove('met');
    }
  });

  const metCount = Object.values(checks).filter(v => v).length;

  strengthFill.className = 'strength-fill';
  if (metCount === 0) {
    strengthFill.style.width = '0';
    strengthText.textContent = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
    strengthText.style.color = '#9ca3af';
  } else if (metCount <= 2) {
    strengthFill.classList.add('weak');
    strengthText.textContent = 'å¼±ã„';
    strengthText.style.color = '#ef4444';
  } else if (metCount === 3) {
    strengthFill.classList.add('medium');
    strengthText.textContent = 'ä¸­ç¨‹åº¦';
    strengthText.style.color = '#f59e0b';
  } else {
    strengthFill.classList.add('strong');
    strengthText.textContent = 'å¼·ã„';
    strengthText.style.color = '#10b981';
  }
}

// ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹ã®æ›´æ–°
function updateFormStatus() {
  const errorNum = Object.keys(errors).length;
  errorCount.textContent = errorNum;

  if (errorNum === 0 && form.checkValidity()) {
    validationStatus.textContent = 'âœ“ æ¤œè¨¼æˆåŠŸ';
    validationStatus.style.color = '#10b981';
    submitBtn.disabled = false;
  } else {
    validationStatus.textContent = 'æ¤œè¨¼ä¸­';
    validationStatus.style.color = '#f59e0b';
    submitBtn.disabled = true;
  }
}

// å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆ
form.querySelectorAll('input').forEach(input => {
  // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  input.addEventListener('input', (e) => {
    const name = e.target.name;
    const value = e.target.type === 'checkbox' ? e.target.checked : e.target.value;

    // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯
    if (name === 'password') {
      checkPasswordStrength(value);
    }

    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
    const error = validateField(name, value);

    if (error) {
      showError(name, error);
      addLog(\`âŒ æ¤œè¨¼ã‚¨ãƒ©ãƒ¼:\`, name);
    } else if (value) {
      showSuccess(name);
      addLog(\`âœ… æ¤œè¨¼æˆåŠŸ:\`, name);
    }

    updateFormStatus();
  });

  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¢ã‚¦ãƒˆæ™‚ã«ã‚‚æ¤œè¨¼
  input.addEventListener('blur', (e) => {
    const name = e.target.name;
    const value = e.target.type === 'checkbox' ? e.target.checked : e.target.value;

    if (value || validators[name]?.required) {
      const error = validateField(name, value);
      if (error) {
        showError(name, error);
      }
    }

    updateFormStatus();
  });
});

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
document.querySelectorAll('.toggle-password').forEach(btn => {
  btn.addEventListener('click', () => {
    const targetId = btn.getAttribute('data-toggle');
    const input = document.getElementById(targetId);

    if (input.type === 'password') {
      input.type = 'text';
      btn.querySelector('.icon').textContent = 'ğŸ™ˆ';
    } else {
      input.type = 'password';
      btn.querySelector('.icon').textContent = 'ğŸ‘ï¸';
    }
  });
});

// ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
form.addEventListener('submit', (e) => {
  e.preventDefault();

  // ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ¤œè¨¼
  const formData = new FormData(form);
  let hasErrors = false;

  for (const [name, value] of formData.entries()) {
    const error = validateField(name, value);
    if (error) {
      showError(name, error);
      hasErrors = true;
    }
  }

  // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®æ¤œè¨¼
  const terms = document.getElementById('terms');
  if (!terms.checked) {
    showError('terms', validators.terms.messages.required);
    hasErrors = true;
  }

  if (hasErrors) {
    addLog('âŒ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å¤±æ•—: ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™');
    return;
  }

  // æˆåŠŸ
  addLog('ğŸ‰ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æˆåŠŸï¼');
  successModal.style.display = 'flex';
});

// ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
document.getElementById('closeModal').addEventListener('click', () => {
  successModal.style.display = 'none';
  form.reset();

  // ã™ã¹ã¦ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
  form.querySelectorAll('input').forEach(input => {
    input.classList.remove('error', 'success');
  });

  document.querySelectorAll('.error-message, .success-message').forEach(el => {
    el.classList.remove('show');
  });

  errors = {};
  updateFormStatus();

  document.getElementById('strengthFill').style.width = '0';
  document.getElementById('strengthText').textContent = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';

  document.querySelectorAll('.requirement').forEach(req => {
    req.classList.remove('met');
  });
});

// åˆæœŸåŒ–
addLog('ğŸ“‹ ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼åˆæœŸåŒ–');
updateFormStatus();
  `}
/>

## ä¸€ç•ªç°¡å˜ãªæ–¹æ³•: HTMLã§æŒ‡å®šã™ã‚‹

å®Ÿã¯ã€JavaScriptã‚’ä½¿ã‚ãªãã¦ã‚‚å…¥åŠ›ãƒã‚§ãƒƒã‚¯ãŒã§ãã¾ã™ï¼

### å¿…é ˆé …ç›®ã«ã™ã‚‹

```html
<input type="text" required />
```

`required` ã‚’æ›¸ãã ã‘ã§ã€Œå¿…ãšå…¥åŠ›ã—ã¦ãã ã•ã„ã€ã«ãªã‚Šã¾ã™ã€‚

### æ–‡å­—æ•°ã‚’åˆ¶é™ã™ã‚‹

```html
<!-- 3æ–‡å­—ä»¥ä¸Šã€20æ–‡å­—ä»¥ä¸‹ -->
<input type="text" minlength="3" maxlength="20" />
```

### ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å°‚ç”¨ã®å…¥åŠ›æ¬„

```html
<input type="email" />
```

ã“ã‚Œã ã‘ã§ã€Œ@ã€ãŒå…¥ã£ã¦ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ã¦ãã‚Œã¾ã™ï¼

### æ•°å­—ã ã‘å…¥åŠ›ã§ãã‚‹

```html
<!-- 1ã€œ100ã®æ•°å­—ã ã‘ -->
<input type="number" min="1" max="100" />
```

### ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```javascript
const input = document.getElementById('username');

input.addEventListener('invalid', (e) => {
  e.preventDefault();

  if (input.validity.valueMissing) {
    input.setCustomValidity('ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
  } else if (input.validity.tooShort) {
    input.setCustomValidity('3æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„');
  } else if (input.validity.patternMismatch) {
    input.setCustomValidity('è‹±æ•°å­—ã®ã¿ä½¿ç”¨ã§ãã¾ã™');
  }
});

// ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
input.addEventListener('input', () => {
  input.setCustomValidity('');
});
```

## JavaScriptã§è‡ªåˆ†ã§ãƒã‚§ãƒƒã‚¯ã™ã‚‹

ã‚‚ã£ã¨ç´°ã‹ããƒã‚§ãƒƒã‚¯ã—ãŸã„ã¨ãã¯ã€JavaScriptã‚’ä½¿ã„ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1: å…¥åŠ›ã•ã‚ŒãŸã‚‰å³ãƒã‚§ãƒƒã‚¯

```javascript
const input = document.getElementById('username');

input.addEventListener('input', () => {
  const value = input.value;

  // 3æ–‡å­—æœªæº€ãªã‚‰ã‚¨ãƒ©ãƒ¼
  if (value.length < 3) {
    showError('3æ–‡å­—ä»¥ä¸Šå…¥åŠ›ã—ã¦ãã ã•ã„');
  } else {
    showOK();
  }
});
```

### ã‚¹ãƒ†ãƒƒãƒ—2: ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹

```javascript
function showError(message) {
  const errorDiv = document.getElementById('error');
  errorDiv.textContent = message; // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
  errorDiv.style.color = 'red';
}

function showOK() {
  const errorDiv = document.getElementById('error');
  errorDiv.textContent = 'âœ“ OK';
  errorDiv.style.color = 'green';
}
```

### ã‚¹ãƒ†ãƒƒãƒ—3: é€ä¿¡å‰ã«å…¨éƒ¨ãƒã‚§ãƒƒã‚¯

```javascript
const form = document.getElementById('myForm');

form.addEventListener('submit', (e) => {
  e.preventDefault(); // é€ä¿¡ã‚’ä¸€æ—¦æ­¢ã‚ã‚‹

  const username = document.getElementById('username').value;
  const email = document.getElementById('email').value;

  // å…¨éƒ¨ãƒã‚§ãƒƒã‚¯
  if (username.length < 3) {
    alert('ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯3æ–‡å­—ä»¥ä¸Š');
    return; // é€ä¿¡ã—ãªã„
  }

  if (!email.includes('@')) {
    alert('æ­£ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return; // é€ä¿¡ã—ãªã„
  }

  // å…¨éƒ¨OKãªã‚‰é€ä¿¡
  alert('ç™»éŒ²å®Œäº†ï¼');
});
```

## éåŒæœŸãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

### ã‚µãƒ¼ãƒãƒ¼å´ãƒã‚§ãƒƒã‚¯ï¼ˆé‡è¤‡ç¢ºèªãªã©ï¼‰

```javascript
class AsyncValidator {
  async checkUsername(username) {
    // ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†
    clearTimeout(this.usernameTimeout);

    return new Promise((resolve) => {
      this.usernameTimeout = setTimeout(async () => {
        try {
          const response = await fetch(\`/api/check-username?username=\${username}\`);
          const data = await response.json();
          resolve(data.available);
        } catch (error) {
          console.error('Validation error:', error);
          resolve(false);
        }
      }, 500); // 500ms ã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹
    });
  }

  async validateUsername(input) {
    const username = input.value;

    // ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    if (username.length < 3) {
      this.showError(input, '3æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„');
      return;
    }

    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
    this.showLoading(input);

    // ã‚µãƒ¼ãƒãƒ¼ãƒã‚§ãƒƒã‚¯
    const available = await this.checkUsername(username);

    if (available) {
      this.showSuccess(input, 'ä½¿ç”¨å¯èƒ½ã§ã™');
    } else {
      this.showError(input, 'ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™');
    }
  }

  showLoading(input) {
    const feedback = input.nextElementSibling;
    feedback.innerHTML = '<span class="loading">ç¢ºèªä¸­...</span>';
  }

  showError(input, message) {
    const feedback = input.nextElementSibling;
    feedback.innerHTML = \`<span class="error">\${message}</span>\`;
    input.classList.add('error');
  }

  showSuccess(input, message) {
    const feedback = input.nextElementSibling;
    feedback.innerHTML = \`<span class="success">âœ“ \${message}</span>\`;
    input.classList.remove('error');
    input.classList.add('success');
  }
}
```

## ã‚ˆãä½¿ã†ãƒã‚§ãƒƒã‚¯æ–¹æ³•

### ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒã‚§ãƒƒã‚¯

```javascript
function checkEmail(email) {
  // @ãŒå…¥ã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
  return email.includes('@');
}

// ã‚‚ã£ã¨æ­£ç¢ºã«ãƒã‚§ãƒƒã‚¯
function checkEmailStrict(email) {
  // ã€Œâ—‹â—‹@â—‹â—‹.â—‹â—‹ã€ã®å½¢ã‹ãƒã‚§ãƒƒã‚¯
  const pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return pattern.test(email);
}
```

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å¼·ã•ã‚’ãƒã‚§ãƒƒã‚¯

```javascript
function checkPasswordStrength(password) {
  let score = 0;

  if (password.length >= 8) score++; // 8æ–‡å­—ä»¥ä¸Š
  if (/[a-z]/.test(password)) score++; // å°æ–‡å­—ã‚’å«ã‚€
  if (/[A-Z]/.test(password)) score++; // å¤§æ–‡å­—ã‚’å«ã‚€
  if (/[0-9]/.test(password)) score++; // æ•°å­—ã‚’å«ã‚€

  if (score <= 1) return 'å¼±ã„';
  if (score === 2) return 'æ™®é€š';
  if (score === 3) return 'å¼·ã„';
  return 'éå¸¸ã«å¼·ã„';
}
```

### é›»è©±ç•ªå·ã®ãƒã‚§ãƒƒã‚¯

```javascript
function checkPhone(phone) {
  // ãƒã‚¤ãƒ•ãƒ³ã‚’æ¶ˆã™
  const numbers = phone.replace(/-/g, '');

  // æ•°å­—ã ã‘ã«ãªã£ãŸã‹ã€10ã€œ11æ¡ã‹
  return /^\d{10,11}$/.test(numbers);
}
```

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. UX ã‚’é‡è¦–

- ã‚¨ãƒ©ãƒ¼ã¯å…·ä½“çš„ã«
- æˆåŠŸã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚‚è¡¨ç¤º
- ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
- ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¢ã‚¦ãƒˆæ™‚ã«æ¤œè¨¼

### 2. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

```html
<div class="form-group">
  <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
  <input
    type="email"
    id="email"
    name="email"
    aria-describedby="email-error"
    aria-invalid="false"
  />
  <div id="email-error" role="alert" aria-live="polite">
    <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
  </div>
</div>
```

```javascript
// ã‚¨ãƒ©ãƒ¼æ™‚
input.setAttribute('aria-invalid', 'true');
errorDiv.textContent = 'ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸';
```

### 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¿¡ç”¨ã—ãªã„**
- ã‚µãƒ¼ãƒãƒ¼å´ã§ã‚‚å¿…ãšæ¤œè¨¼
- XSS å¯¾ç­–ï¼ˆå…¥åŠ›å€¤ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰
- CSRF ãƒˆãƒ¼ã‚¯ãƒ³ã®ä½¿ç”¨

## ã¾ã¨ã‚

å…¥åŠ›ãƒã‚§ãƒƒã‚¯ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‚’ä½œã‚‹ã«ã¯ï¼š

1. **ç°¡å˜ãªãƒã‚§ãƒƒã‚¯ã¯HTMLã§**
   - `required`ã€`minlength`ã€`type="email"` ãªã©

2. **ç´°ã‹ã„ãƒã‚§ãƒƒã‚¯ã¯JavaScriptã§**
   - å…¥åŠ›ã•ã‚ŒãŸã‚‰å³ãƒã‚§ãƒƒã‚¯
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å„ªã—ã**
   - ã€Œä½•ãŒé–“é•ã£ã¦ã‚‹ã‹ã€ã‚’ã¯ã£ãã‚Šä¼ãˆã‚‹
   - âœ“ãƒãƒ¼ã‚¯ã§OKã‚’ä¼ãˆã‚‹
   - é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™å‰ã«ã‚¨ãƒ©ãƒ¼ã‚’æ•™ãˆã‚‹

ã“ã‚Œã§ã€ä½¿ã„ã‚„ã™ã„å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ãŒä½œã‚Œã¾ã™ï¼

## å‚è€ƒãƒªãƒ³ã‚¯

- [Constraint Validation - MDN](https://developer.mozilla.org/ja/docs/Web/Guide/HTML/Constraint_validation)
- [Form Validation UX - Nielsen Norman Group](https://www.nngroup.com/articles/errors-forms-design-guidelines/)
- [WCAG Form Guidelines](https://www.w3.org/WAI/tutorials/forms/)
